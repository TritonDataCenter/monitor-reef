# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at https://mozilla.org/MPL/2.0/.
#
# Copyright 2026 Edgecast Cloud LLC.

[workspace]
members = [
    "apis/bugview-api",
    "apis/jira-api",
    "apis/rebalancer-agent-api",
    "apis/rebalancer-manager-api",
    "apis/rebalancer-types",
    "cli/bugview-cli",
    "cli/rebalancer-adm",
    "clients/internal/bugview-client",
    "clients/internal/jira-client",
    "clients/internal/rebalancer-manager-client",
    "openapi-manager",
    "services/bugview-service",
    "services/jira-stub-server",
    "services/rebalancer-agent",
    "services/rebalancer-manager",

    # Modernized libraries:
    "libs/fast",
    "libs/quickcheck-helpers",
    "libs/libmanta",
    "libs/moray",
    "libs/qorb-manatee-resolver",
    "libs/sharkspotter",

    # Legacy (not modernized - kept as reference):
    #"libs/rebalancer-legacy/agent",
    #"libs/rebalancer-legacy/manager",
    #"libs/rebalancer-legacy/rebalancer",
]
resolver = "2"

[workspace.package]
edition = "2024"

[profile.dev]
panic = "abort"

[profile.release]
panic = "abort"

[workspace.lints.clippy]
unwrap_used = "deny"
expect_used = "deny"

[workspace.dependencies]
askama = "0.15"
anyhow = "1.0"
camino = "1.1"
cargo_toml = "0.22"
chrono = "0.4"
clap = { version = "4.5", features = ["derive", "env"] }
dropshot = { version = "0.16" }
dropshot-api-manager = "0.3"
dropshot-api-manager-types = "0.3"
openapiv3 = "2.0"
progenitor = "0.11"
progenitor-client = "0.11"
# reqwest needs to track wth progenitor-client
reqwest = { version = "0.12", default-features = false, features = ["json", "rustls-tls"] }
# NOTE: schemars version is tied to dropshot compatibility
# Dropshot 0.16.x requires schemars 0.8.x
# Do not upgrade to schemars 1.x without also upgrading dropshot
schemars = { version = "0.8", features = ["derive"] }
semver = "1.0"
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
thiserror = "2"
tokio = { version = "1.48", features = ["full"] }
tracing = "0.1"
tracing-subscriber = { version = "0.3", features = ["env-filter"] }
qorb = "0.4"
uuid = { version = "1.17", features = ["v4"] }

# Test dependencies
assert_cmd = "2.0"
escargot = "0.5"
predicates = "3.1"
httptest = "0.16"
wiremock = "0.6"
